<div class="dialog-form-header padding-bottom padding-large">
  <img class="dialog-form-header_icon padding-bottom padding-xsmall" src="{{ settings.download_catalogue_icon_url }}" alt="foodie page download catalog form icon">
  {% render 'module-header', 
    title: settings.download_catalogue_title,
    body: settings.download_catalogue_body,
    text_horizontal_alignment: 'left',
  %}
</div>

<div class="dialog-form-body">
  {% form 'contact', class: 'form' %}

    <div class="input-container">
      <input type="hidden" name="contact[tags]" value="download-catalogue">
    
      <div class="field-wrapper margin-bottom margin-medium">

        <div class="field-group">
          <label class="text-size-tiny uppercase" for="ContactForm-name">{{ settings.download_catalogue_input_name_label }}</label>
        
          <input
            id="ContactForm-name"
            type="name"
            name="contact[name]"
            class="field_input"
            value="{{ form.name }}"
            aria-required="true"
            autocorrect="off"
            autocapitalize="off"
            autocomplete="email"
            {% if form.errors %}
              autofocus
              aria-invalid="true"
              aria-describedby="Contact-error--{{ section.id }}"
            {% elsif form.posted_successfully? %}
              aria-describedby="Contact-success--{{ section.id }}"
            {% endif %}
            placeholder="{{ settings.download_catalogue_input_name_placeholder }}"
            required
          >
        </div>

        <div class="field-group">
          <label class="text-size-tiny uppercase" for="ContactForm-name">{{ settings.download_catalogue_input_email_label }}</label>

          <input
            id="ContactForm-email"
            type="email"
            name="contact[email]"
            class="field_input"
            value="{{ form.email }}"
            aria-required="true"
            autocorrect="off"
            autocapitalize="off"
            autocomplete="email"
            {% if form.errors %}
              autofocus
              aria-invalid="true"
              aria-describedby="Contact-error--{{ section.id }}"
            {% elsif form.posted_successfully? %}
              aria-describedby="Contact-success--{{ section.id }}"
            {% endif %}
            placeholder="{{ settings.download_catalogue_input_email_placeholder }}"
            required
          >
        </div>

      </div>

      <button type="submit" class="button contact-submit-button" name="commit" id="Subscribe" aria-label="{{ 'contact.button_label' | t }}">
        <span>{{ settings.download_catalogue_cta_text }}</span>
      </button>
    </div>

    {%- if form.errors -%}
      <small class="text-size-tiny text-color-grey-500 contact-form__message form__message margin-top margin-small" id="Contact-error--{{ section.id }}">
        {% render 'icon-error' %}
        {{ form.errors.translated_fields['email'] | capitalize }} 
        {{ form.errors.messages['email'] }}
      </small>
    {%- endif -%}

    {%- if form.posted_successfully? -%}

      <script type="module">
        const initDownloadFromForm = () => {
          sessionStorage.setItem('download-catalogue-form', 'true');

          setTimeout(() => {
            if (window.readFormSessionStorage) {
              window.readFormSessionStorage();
            }
          }, 1000)
        }

        initDownloadFromForm()
      </script>

      <div style="display: flex; flex-direction: column; align-items: center; justify-content: center;" class="text-align-center">
        <h3 class="text-size-tiny text-color-grey-500 form__message" id="Contact-success--{{ section.id }}" tabindex="-1" autofocus>
          {% render 'icon-success' %}
          {{ settings.download_catalogue_success_message }}
        </h3>
        <a class="link text-size-tiny margin-top margin-xsmall" target="_blank" href="{{ settings.download_catalogue_download_file_url }}" download>Click here to download our Corporate Gifting Catalogue PDF</a>
      </div>
    {%- endif -%}
    
  {% endform %}
</div>